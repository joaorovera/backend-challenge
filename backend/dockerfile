FROM python:3.11-slim

WORKDIR /app

# O docker copia o arquivo requirements.txt para o contêiner
COPY requirements.txt .

# Instala as dependências
RUN pip install --upgrade pip
RUN pip install --no-cache-dir -r requirements.txt

# O docker copia os arquivos do projeto
COPY . .

# O docker define as variáveis de ambiente
ENV PORT=5000
ENV FLASK_APP=run.py
ENV FLASK_ENV=production
ENV MAIL_HOST="smtp.gmail.com"
ENV MAIL_SECURE="true"
ENV MAIL_PORT=465
ENV RECAPTCHA_SECRET="6Lejt1wqAAAAAAmV7N7PEymep_sM0ZOOydDNPDWs"
ENV RECAPTCHA_URL="https://www.google.com/recaptcha/api/siteverify"
ENV ORIGINS="http://localhost:5000"
ENV MAIL_AUTH_USER="joaorovera73@gmail.com"
ENV MAIL_AUTH_PASS="axju idyp dexx swhu"
ENV TEXT_MAIL_TITLE="Formulário de Contato"
ENV DESTINY="{email}"
ENV TEXT_MAIL_BODY="E-mail de: {email} Assunto: {comment}"
ENV TEXT_MAIL_HTML="Assunto: {comment}"

# Porta que o Flask irá rodar
EXPOSE $PORT

# Comando para iniciar a aplicação Flask
CMD ["flask", "run", "--host=0.0.0.0"]
